{% load static %}
{% load tags %}

{% display_cart_items request as carts %}
{% for cart in carts %}
<div class="card mb-3 text-bg-light shadow-lg">
    <div class="card-header">
        <h5 class="card-title">
            <a href="{% url 'main:product' cart.contents.slug %}" class="text-decoration-none text-dark">
                {{cart.contents.title}}
            </a>
        </h5>
    </div>
    <ul class="list-group list-group-flush">
        <li class="list-group-item">
            <div class="row text-center">
                <div class="col p-0">
                    <div class="input-group">
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-dark btn-sm decrement"
                                data-cart-id="{{ cart.id }}"
                                data-cart-change-url="{% url "main:cart_change" %}">
                                {% csrf_token %}
                                -</button>

                        </span>
                        <input type="text" class="form-control number" value="{{ cart.quantity }}"
                            readonly>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-dark btn-sm increment"
                                data-cart-id="{{ cart.id }}" 
                                data-cart-change-url="{% url "main:cart_change" %}">
                                {% csrf_token %}
                                +</button>

                        </span>
                    </div>
                </div>
                <div class="col p-0">
                    <p>{{ cart.contents.price }}$</p>
                </div>
                <div class="col p-0"><strong> = {{ cart.total_item_price }}$</strong></div>
                <div class="col p-0">
                    <a href="{% url "main:cart_delete" %}" class="remove-from-cart" data-cart-id="{{ cart.id }}">
                        {% csrf_token %}
                        <img class="mx-1" src="{% static "trash_bin.png" %}"
                            alt="Remove" width="16" height="16">
                    </a>
                </div>
            </div>
        </li>
    </ul>
</div> 
{% endfor %}
<div class="card mb-3 shadow-lg">
    <div class="card-footer">
        <p class="float-left">Total <strong>{{carts.total_items}}</strong> items for</p>
        <h4 class="float-left"><strong>{{carts.total_price}}$</strong></h4>
    </div>
</div>
{% if carts and '/order/' not in request.path %}
<a class="btn btn-dark" href="{% url "orders:create_order" %}">
    Order
</a>
{% endif %}